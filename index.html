<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Primary Math Quiz</title>
  <style>
    body { font-family: Arial, sans-serif; text-align:center; background:#f0f0f0; padding:20px; }
    .box { max-width:500px; margin:20px auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.1);}
    input, button, select { font-size:18px; margin-top:10px; padding:5px 10px; text-align:center; }
    hr { margin:20px 0; }
    #question, #result, #score { font-size:20px; margin:10px 0; }
  </style>
</head>
<body>

<!-- Start Page -->
<div class="box" id="startPage">
  <h2>Primary Math Quiz ‚úèÔ∏è</h2>
  <div>
    Student Name:<br>
    <input id="studentName" placeholder="e.g. John">
  </div>
  <div>
    Select Year:<br>
    <select id="yearSelect">
      <option value="">--Select Year--</option>
      <option value="Year 3">Year 3</option>
      <option value="Year 6">Year 6</option>
    </select>
  </div>
  <button onclick="startTest()">Start Quiz</button>
</div>

<!-- Quiz Page -->
<div class="box" id="quizPage" style="display:none;">
  <div id="question"></div>
  <input type="number" id="answerInput" placeholder="Your answer">
  <br>
  <button onclick="submitAnswer()">Submit</button>
  <div id="result"></div>
</div>

<!-- Score Page -->
<div class="box" id="scorePage" style="display:none;">
  <h2>Quiz Completed ‚úÖ</h2>
  <div id="score"></div>
  <button onclick="restartQuiz()">Restart Quiz</button>
</div>

<!-- Firebase CDN -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  // üîë Firebase configuration
  const firebaseConfig = {
    apiKey: "",
    authDomain: "kids-test-fc074.firebaseapp.com",
    projectId: "kids-test-fc074",
    storageBucket: "kids-test-fc074.firebasestorage.app",
    messagingSenderId: "114800822327",
    appId: "1:114800822327:web:b6aad8ec86b91ac1a497b2"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // Questions for Year 3 and Year 6
  const questions = {
    "Year 3": [
      {q:"5 + 3 =", a:8},
      {q:"10 - 4 =", a:6},
      {q:"2 √ó 3 =", a:6},
      {q:"12 √∑ 3 =", a:4},
      {q:"7 + 6 =", a:13}
    ],
    "Year 6": [
      {q:"25 + 17 =", a:42},
      {q:"56 - 29 =", a:27},
      {q:"8 √ó 7 =", a:56},
      {q:"81 √∑ 9 =", a:9},
      {q:"15 √ó 4 =", a:60}
    ]
  };

  let studentName = "";
  let selectedYear = "";
  let currentQuestionIndex = 0;
  let score = 0;

  function startTest(){
    studentName = document.getElementById("studentName").value.trim();
    selectedYear = document.getElementById("yearSelect").value;
    if(!studentName || !selectedYear){
      alert("Please enter student name and select year.");
      return;
    }
    document.getElementById("startPage").style.display = "none";
    document.getElementById("quizPage").style.display = "block";
    currentQuestionIndex = 0;
    score = 0;
    showQuestion();
  }

  function showQuestion(){
    const q = questions[selectedYear][currentQuestionIndex];
    document.getElementById("question").innerText = "Question " + (currentQuestionIndex+1) + ": " + q.q;
    document.getElementById("answerInput").value = "";
    document.getElementById("result").innerText = "";
  }

  function submitAnswer(){
    const q = questions[selectedYear][currentQuestionIndex];
    const userAnswer = Number(document.getElementById("answerInput").value);
    const isCorrect = userAnswer === q.a;
    document.getElementById("result").innerText = isCorrect ? "‚úÖ Correct!" : "‚ùå Wrong";
    if(isCorrect) score++;

    // Save to Firestore
    db.collection("student_scores").add({
      studentName: studentName,
      year: selectedYear,
      question: q.q,
      correctAnswer: q.a,
      studentAnswer: userAnswer,
      isCorrect: isCorrect,
      createdAt: new Date()
    });

    currentQuestionIndex++;
    if(currentQuestionIndex < questions[selectedYear].length){
      setTimeout(showQuestion, 800);
    } else {
      setTimeout(showScore, 800);
    }
  }

  function showScore(){
    document.getElementById("quizPage").style.display = "none";
    document.getElementById("scorePage").style.display = "block";
    document.getElementById("score").innerText = "Total Score: " + score + " / " + questions[selectedYear].length;
  }

  function restartQuiz(){
    document.getElementById("scorePage").style.display = "none";
    document.getElementById("startPage").style.display = "block";
    document.getElementById("studentName").value = "";
    document.getElementById("yearSelect").value = "";
  }
</script>
</body>
</html>
